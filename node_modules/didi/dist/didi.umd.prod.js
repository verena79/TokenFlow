!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.Didi={})}(this,function(t){"use strict";var n=/^class /;function e(t){return"[object Array]"===Object.prototype.toString.call(t)}function r(t,n){return Object.prototype.hasOwnProperty.call(t,n)}function o(){var t=Array.prototype.slice.call(arguments);1===t.length&&e(t[0])&&(t=t[0]);var n=t.pop();return n.$inject=t,n}var i=/constructor\s*[^(]*\(\s*([^)]*)\)/m,c=/^(?:async )?(?:function\s*)?[^(]*\(\s*([^)]*)\)/m,u=/\/\*([^*]*)\*\//m;function f(t){if("function"!=typeof t)throw new Error('Cannot annotate "'+t+'". Expected a function!');var e=t.toString().match(function(t){return n.test(t.toString())}(t)?i:c);return e&&e[1]&&e[1].split(",").map(function(t){return(e=t.match(u))?e[1].trim():t.trim()})||[]}function a(){var t=[];this.factory=function(n,e){return t.push([n,"factory",e]),this},this.value=function(n,e){return t.push([n,"value",e]),this},this.type=function(n,e){return t.push([n,"type",e]),this},this.forEach=function(n){t.forEach(n)}}t.annotate=o,t.parseAnnotations=f,t.Module=a,t.Injector=function t(n,i){i=i||{get:function(t,n){if(c.push(t),!1===n)return null;throw h('No provider for "'+t+'"!')}};var c=[],u=this._providers=Object.create(i._providers||null),s=this._instances=Object.create(null),p=s.injector=this,h=function(t){var n=c.join(" -> ");return c.length=0,new Error(n?t+" (Resolving: "+n+")":t)},l=function(t,n){if(!u[t]&&-1!==t.indexOf(".")){for(var e=t.split("."),o=l(e.shift());e.length;)o=o[e.shift()];return o}if(r(s,t))return s[t];if(r(u,t)){if(-1!==c.indexOf(t))throw c.push(t),h("Cannot resolve circular dependency!");return c.push(t),s[t]=u[t][0](u[t][1]),c.pop(),s[t]}return i.get(t,n)},d=function(t,n){if(void 0===n&&(n={}),"function"!=typeof t){if(!e(t))throw new Error('Cannot invoke "'+t+'". Expected a function!');t=o(t.slice())}return{fn:t,dependencies:(t.$inject||f(t)).map(function(t){return r(n,t)?n[t]:l(t)})}},v=function(t){var n=d(t),e=n.fn,r=n.dependencies;return new(Function.prototype.bind.apply(e,[null].concat(r)))},y=function(t,n,e){var r=d(t,e),o=r.fn,i=r.dependencies;return o.apply(n,i)},_=function(t){return o(function(n){return t.get(n)})},j={factory:y,type:v,value:function(t){return t}};n.forEach(function(n){function r(t,n){return"value"!==t&&e(n)&&(n=o(n.slice())),n}if(n instanceof a)n.forEach(function(t){var n=t[0],e=t[1],o=t[2];u[n]=[j[e],r(e,o),e]});else if("object"==typeof n)if(n.__exports__){var i=Object.keys(n).reduce(function(t,e){return"__"!==e.substring(0,2)&&(t[e]=n[e]),t},Object.create(null)),c=new t((n.__modules__||[]).concat([i]),p),f=o(function(t){return c.get(t)});n.__exports__.forEach(function(t){u[t]=[f,t,"private",c]})}else Object.keys(n).forEach(function(t){if("private"!==n[t][2]){var e=n[t][0],o=n[t][1];u[t]=[j[e],r(e,o),e]}else u[t]=n[t]})}),this.get=l,this.invoke=y,this.instantiate=v,this.createChild=function(n,e){if(e&&e.length){var r,o,i,c,f=Object.create(null),a=Object.create(null),s=[],h=[],l=[];for(var d in u)r=u[d],-1!==e.indexOf(d)&&("private"===r[2]?-1===(o=s.indexOf(r[3]))?(i=r[3].createChild([],e),c=_(i),s.push(r[3]),h.push(i),l.push(c),f[d]=[c,d,"private",i]):f[d]=[l[o],d,"private",h[o]]:f[d]=[r[2],r[1]],a[d]=!0),"factory"!==r[2]&&"type"!==r[2]||!r[1].$scope||e.forEach(function(t){-1!==r[1].$scope.indexOf(t)&&(f[d]=[r[2],r[1]],a[t]=!0)});e.forEach(function(t){if(!a[t])throw new Error('No provider for "'+t+'". Cannot use provider from the parent!')}),n.unshift(f)}return new t(n,p)}},Object.defineProperty(t,"__esModule",{value:!0})});
